--
-- Standard procedures to use CSV as a commom SQL table, to link or populate your database.
--   (this script is a cache, "kx_" prefixed file, generated by software from datapackage.json)
--
-- 1. cd /tmp
-- 2. git clone https://github.com/datasets-br/state-codes.git
-- 3. PGPASSWORD=postgres psql -h localhost -U postgres obsjats < /tmp/state-codes/csv2foreign_tables.sql
-- 4. ... populate your database using the tables tmpcsv_* defined below...
-- 5. (opcional) DROP SERVER csv_files CASCADE;
--


CREATE EXTENSION file_fdw;
CREATE SERVER csv_files FOREIGN DATA WRAPPER file_fdw;


CREATE FOREIGN TABLE tmpcsv_state_codes (
	subdivision text,
	name text,
	id int,
	idIBGE int,
	place_id int,
	wdId text,
	lexLabel text,
	creation int,
	extinction int,
	category text,
	timeZone text,
	utcOffset int,
	utcOffset_DST int,
	notes text
)   SERVER csv_files OPTIONS ( 
     filename '/tmp/state-codes/data/br-state-codes.csv', 
       format 'csv', 
       header 'true'
);

CREATE VIEW tmpcsv_state_codes_current AS
  SELECT * 
  FROM tmpcsv_state_codes
  WHERE extinction IS NULL
  ORDER BY subdivision
;
  
